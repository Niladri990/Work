<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>User Profile - Swachhata Corporate</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 2rem;
    background-color: #f8f9fa;
    color: #212529;
  }
  .profile-container {
    max-width: 600px;
    margin: 0 auto;
    background: white;
    padding: 2rem 2.5rem;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  }
  h1 {
    color: #198754;
    font-weight: 700;
    font-size: 2rem;
    margin-bottom: 1rem;
    border-bottom: 3px solid #198754;
    padding-bottom: 0.5rem;
  }
  .profile-header {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 2rem;
  }
  .profile-pic {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    background-color: #d9e9d9;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    color: #198754;
    font-weight: 700;
    user-select: none;
  }
  .profile-info {
    flex: 1;
  }
  .profile-info label {
    font-weight: 700;
    display: block;
    margin-top: 1.2rem;
    color: #333;
    font-size: 1.1rem;
  }
  .profile-info span {
    display: block;
    margin-top: 0.3rem;
    font-size: 1.05rem;
    color: #555;
  }
  .edit-btn {
    margin-top: 2rem;
    background-color: #198754;
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    font-size: 1.1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  .edit-btn:hover {
    background-color: #146c43;
  }
  a.back-link {
    display: inline-block;
    margin-top: 2rem;
    color: #009dfe;
    text-decoration: none;
    font-weight: 600;
    font-size: 1rem;
  }
  a.back-link:hover {
    text-decoration: underline;
  }
  /* Modal styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 1500;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    overflow: auto;
    background-color: rgba(0,0,0,0.5);
  }
  .modal-content {
    background-color: #fff;
    margin: 5% auto;
    padding: 2rem 2.5rem;
    border-radius: 12px;
    max-width: 500px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.25);
  }
  .modal-content h2 {
    margin-top: 0;
    color: #198754;
    font-weight: 700;
    margin-bottom: 1rem;
  }
  .modal-content label {
    display: block;
    margin-top: 1rem;
    font-weight: 600;
    color: #333;
  }
  .modal-content input {
    width: 100%;
    padding: 0.6rem 0.8rem;
    margin-top: 0.3rem;
    border: 1.5px solid #ced4da;
    border-radius: 6px;
    font-size: 1rem;
    box-sizing: border-box;
  }
  .modal-content input:focus {
    outline: none;
    border-color: #198754;
    box-shadow: 0 0 5px #198754aa;
  }
  .modal-buttons {
    margin-top: 1.8rem;
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
  }
  .btn-cancel, .btn-save {
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    border-radius: 6px;
    border: none;
    cursor: pointer;
  }
  .btn-cancel {
    background-color: #6c757d;
    color: white;
  }
  .btn-cancel:hover {
    background-color: #5a6268;
  }
  .btn-save {
    background-color: #198754;
    color: white;
  }
  .btn-save:hover {
    background-color: #146c43;
  }
</style>
</head>
<body>
  <div class="profile-container">
    <h1>User Profile</h1>
    <div class="profile-header">
      <div class="profile-pic" id="profilePic">U</div>
      <div class="profile-info">
        <label>Name:</label>
        <span id="profileName">Loading...</span>
        <label>Email:</label>
        <span id="profileEmail">Loading...</span>
        <label>Phone:</label>
        <span id="profilePhone">Loading...</span>
        <label>Vehicle:</label>
        <span id="profileVehicle">Loading...</span>
        <label>Rating:</label>
        <span id="profileRating">Loading...</span>
        <label>Total Earnings:</label>
        <span id="profileEarnings">Loading...</span>
      </div>
    </div>
    <button class="edit-btn" id="editProfileBtn">Edit Profile</button>
    <a href="Main2.html" class="back-link">← Back to Dashboard</a>
  </div>

  <!-- Edit Profile Modal -->
  <div id="editModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-content">
      <h2 id="modalTitle">Edit Profile</h2>
      <form id="editProfileForm">
        <label for="editName">Name:</label>
        <input type="text" id="editName" name="editName" required />
        <label for="editEmail">Email:</label>
        <input type="email" id="editEmail" name="editEmail" required />
        <label for="editPhone">Phone:</label>
        <input type="tel" id="editPhone" name="editPhone" required />
        <label for="editVehicle">Vehicle:</label>
        <input type="text" id="editVehicle" name="editVehicle" required />
        <label for="editRating">Rating:</label>
        <input type="number" id="editRating" name="editRating" min="0" max="5" step="0.1" required />
        <label for="editEarnings">Total Earnings:</label>
        <input type="number" id="editEarnings" name="editEarnings" min="0" step="0.01" required />
        <div class="modal-buttons">
          <button type="button" class="btn-cancel" id="cancelBtn">Cancel</button>
          <button type="submit" class="btn-save">Save</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Load profile data from localStorage and display
    function loadProfile() {
      const profile = JSON.parse(localStorage.getItem('driverProfile')) || {};
      document.getElementById('profileName').textContent = profile.fullName || 'N/A';
      document.getElementById('profileEmail').textContent = profile.email || 'N/A';
      document.getElementById('profilePhone').textContent = profile.phone || 'N/A';
      document.getElementById('profileVehicle').textContent = profile.vehicle || 'N/A';
      document.getElementById('profileRating').textContent = profile.rating !== undefined ? profile.rating : 'N/A';
      document.getElementById('profileEarnings').textContent = profile.totalEarnings !== undefined ? `₹${profile.totalEarnings.toFixed(2)}` : 'N/A';

      // Set profile pic initial
      const pic = document.getElementById('profilePic');
      if (profile.fullName && profile.fullName.length > 0) {
        pic.textContent = profile.fullName.charAt(0).toUpperCase();
      } else {
        pic.textContent = 'U';
      }
    }

    // Modal handling
    const editModal = document.getElementById('editModal');
    const editProfileBtn = document.getElementById('editProfileBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    const editProfileForm = document.getElementById('editProfileForm');

    editProfileBtn.addEventListener('click', () => {
      const profile = JSON.parse(localStorage.getItem('driverProfile')) || {};
      document.getElementById('editName').value = profile.fullName || '';
      document.getElementById('editEmail').value = profile.email || '';
      document.getElementById('editPhone').value = profile.phone || '';
      document.getElementById('editVehicle').value = profile.vehicle || '';
      document.getElementById('editRating').value = profile.rating !== undefined ? profile.rating : '';
      document.getElementById('editEarnings').value = profile.totalEarnings !== undefined ? profile.totalEarnings : '';
      editModal.style.display = 'block';
      editModal.setAttribute('aria-hidden', 'false');
    });

    cancelBtn.addEventListener('click', () => {
      editModal.style.display = 'none';
      editModal.setAttribute('aria-hidden', 'true');
    });

    window.addEventListener('click', (event) => {
      if (event.target === editModal) {
        editModal.style.display = 'none';
        editModal.setAttribute('aria-hidden', 'true');
      }
    });

    editProfileForm.addEventListener('submit', (event) => {
      event.preventDefault();
      const updatedProfile = {
        fullName: document.getElementById('editName').value.trim(),
        email: document.getElementById('editEmail').value.trim(),
        phone: document.getElementById('editPhone').value.trim(),
        vehicle: document.getElementById('editVehicle').value.trim(),
        rating: parseFloat(document.getElementById('editRating').value),
        totalEarnings: parseFloat(document.getElementById('editEarnings').value)
      };
      localStorage.setItem('driverProfile', JSON.stringify(updatedProfile));
      loadProfile();
      editModal.style.display = 'none';
      editModal.setAttribute('aria-hidden', 'true');
      alert('Profile updated successfully!');
    });

    window.onload = loadProfile;
  </script>
</body>
</html>
